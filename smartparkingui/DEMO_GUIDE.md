# 智能停车系统 - UI功能演示指南

## 前提条件

1. **后端服务器运行**
   ```bash
   cd smart_parking_backend
   go run main.go
   ```
   确保服务器运行在 `http://127.0.0.1:8080`

2. **Qt环境**
   - Qt 6.8.3 或更高版本
   - Qt Creator已安装并配置

## 构建和运行

### 在Qt Creator中

1. 打开项目
   - 在Qt Creator中打开 `smartparkingui/CMakeLists.txt`
   - 选择构建套件（Kit）：Desktop Qt 6.8.3

2. 配置项目
   - 选择构建目录（如：`build/Desktop_Qt_6_8_3-Debug`）
   - 点击"配置项目"

3. 构建项目
   - 点击"构建"按钮或按 `Ctrl+B`
   - 等待构建完成

4. 运行项目
   - 点击"运行"按钮或按 `Ctrl+R`
   - 应用将启动并显示登录界面

## 功能演示流程

### 一、用户角色演示

#### 1. 用户注册
1. 启动应用后，进入登录页面
2. 点击"注册新用户"按钮
3. 填写信息：
   - 用户名：`demo_user`
   - 密码：`demo123456`
   - 手机号：`13800000001`
   - 邮箱：`demo@example.com`（可选）
   - 车牌号：`粤A12345`（必填）
4. 点击"注册"按钮
5. 注册成功后自动返回登录页面

#### 2. 用户登录
1. 在登录页面选择"用户"模式
2. 输入手机号和密码
3. 点击"登录"按钮
4. 登录成功后进入用户主页面

#### 3. 停车状态查看
1. 在用户主页面，默认显示"停车状态"标签页
2. 系统自动加载当前用户的在场停车记录
3. 如果有车辆在场：
   - 显示车牌号、停车场名称、入场时间等信息
   - 显示"离开"按钮
4. 如果没有车辆在场：
   - 显示"当前暂无车辆在使用停车场"
   - 显示"停车"按钮

#### 4. 车辆入场（停车）
1. 点击"停车"按钮
2. 系统加载停车场列表
3. 选择停车场（需要实现选择对话框）
4. 调用车辆入场接口
5. 显示停车成功信息，更新停车状态

#### 5. 车辆出场（离开）
1. 如果有车辆在场，点击"离开"按钮
2. 系统计算停车费用
3. 显示费用详情（停车费、违规罚款等）
4. 自动跳转到支付页面
5. 完成支付后，更新停车状态

#### 6. 预订车位
1. 切换到"预订信息"标签页
2. 点击"新建预订"按钮
3. 选择停车场、车辆、开始时间、结束时间
4. 点击"查看车位可视化"查看车位状态
5. 点击"提交预订"完成预订
6. 预订成功后返回，列表自动更新

#### 7. 查看订单历史
1. 切换到"订单历史"标签页
2. 系统自动加载用户的支付记录
3. 查看订单详情：
   - 订单ID
   - 金额
   - 支付方式
   - 支付状态
   - 支付时间
4. 如果有待支付订单，点击"支付"按钮完成支付

#### 8. 查看违规记录
1. 切换到"违规记录"标签页
2. 系统自动加载用户的违规记录
3. 查看违规详情：
   - 违规类型
   - 违规时间
   - 罚款金额
   - 处理状态
4. 如果有未处理的违规，点击"支付罚款"按钮

### 二、管理员角色演示

#### 1. 管理员登录
1. 在登录页面选择"管理员"模式
2. 输入管理员手机号和密码
3. 点击"登录"按钮
4. 登录成功后进入管理员主页面

#### 2. 系统管理员功能

**停车场管理**
1. 切换到"停车场管理"标签页
2. 查看所有停车场列表
3. 点击"添加停车场"按钮（需要实现）
4. 点击"查看详情"查看停车场详细信息

**违规分析**
1. 切换到"违规分析"标签页
2. 选择年份和月份
3. 点击"查询"按钮
4. 查看违规统计数据

#### 3. 停车场管理员功能

**车位管理**
1. 切换到"车位管理"标签页
2. 查看该管理员管理的停车场车位列表
3. 点击"修改状态"按钮修改车位状态

**数据分析**
1. 切换到"数据分析"标签页
2. 选择时间范围
3. 点击"查询"按钮
4. 查看使用率分析结果

**报表生成**
1. 切换到"报表生成"标签页
2. 选择报表类型（月度/年度）
3. 选择年份和月份
4. 点击"生成报表"按钮
5. 查看生成的报表数据

## 测试数据准备

### 创建测试用户
使用以下API创建测试用户：

```bash
curl -X POST http://127.0.0.1:8080/api/v1/register \
  -H "Content-Type: application/json" \
  -d '{
    "users_list": {
      "username": "testuser",
      "password": "test123456",
      "phone": "13800000001",
      "email": "test@example.com"
    },
    "vehicles": [{
      "license_plate": "粤A12345"
    }]
  }'
```

### 创建测试管理员
```bash
curl -X POST http://127.0.0.1:8080/admin/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13900000001",
    "password": "admin123456",
    "role": "lot_admin",
    "lot_id": 1
  }'
```

## 常见问题

### 1. 构建错误：找不到QML文件
**解决方案**：确保 `resources.qrc` 文件在项目根目录，且路径正确

### 2. 运行时错误：无法连接到服务器
**解决方案**：
- 检查后端服务器是否运行
- 检查API地址配置（默认：http://127.0.0.1:8080）

### 3. 登录失败
**解决方案**：
- 确保用户已注册
- 检查手机号和密码是否正确
- 查看控制台错误信息

### 4. 数据不显示
**解决方案**：
- 检查网络连接
- 查看浏览器控制台（F12）的网络请求
- 检查后端API响应

## 功能检查清单

- [ ] 用户注册功能
- [ ] 用户登录功能
- [ ] 停车状态查看
- [ ] 车辆入场功能
- [ ] 车辆出场功能
- [ ] 预订车位功能
- [ ] 订单历史查看
- [ ] 违规记录查看
- [ ] 支付功能
- [ ] 管理员登录
- [ ] 停车场管理（系统管理员）
- [ ] 车位管理（停车场管理员）
- [ ] 数据分析功能
- [ ] 报表生成功能

## 下一步改进

1. **完善UI交互**
   - 添加停车场选择对话框
   - 添加车辆选择功能
   - 改进错误提示显示

2. **优化用户体验**
   - 添加加载动画
   - 添加数据刷新功能
   - 改进响应式布局

3. **增强功能**
   - 添加数据导出功能
   - 添加图表展示
   - 添加实时数据更新

